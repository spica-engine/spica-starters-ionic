{"version":3,"sources":["./src/app/forum/pages/survey/survey-routing.module.ts","./src/app/forum/pages/survey/survey.module.ts","./src/app/forum/pages/survey/survey.page.ts","./src/app/forum/pages/survey/survey.page.scss","./src/app/forum/pages/survey/survey.page.html"],"names":[],"mappings":"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","file":"src_app_forum_pages_survey_survey_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SurveyPage } from './survey.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SurveyPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SurveyPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SurveyPageRoutingModule } from './survey-routing.module';\n\nimport { SurveyPage } from './survey.page';\nimport { SpicaComponentsModule } from 'src/app/components/components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SurveyPageRoutingModule,\n    SpicaComponentsModule\n  ],\n  declarations: [SurveyPage]\n})\nexport class SurveyPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../../services/auth.service';\nimport * as DataService from '../../services/bucket';\nimport { environment } from '../../services/environment';\n\n@Component({\n  selector: 'app-survey',\n  templateUrl: './survey.page.html',\n  styleUrls: ['./survey.page.scss'],\n})\nexport class SurveyPage {\n  survey: DataService.Survey[] = [];\n  control: DataService.Survey[] = [];\n  user: DataService.User;\n  userId: string;\n  surveyAnswers = {};\n  defaultImage = environment.user_img;\n\n  constructor(private _authService: AuthService, private _router: Router) {\n    _authService.initBucket();\n  }\n\n  async ionViewWillEnter() {\n    this.userId = (await this._authService.getUser().toPromise())?._id;\n    if (!this.userId) {\n      this._router.navigateByUrl('/forum/authorization', {replaceUrl: true});\n    } else{\n      await this.getUser();\n      this.getSurvey();\n    }\n  }\n\n  async getUser() {\n    this.user = await DataService.user.get(this.userId);\n  }\n  async _vote(survey, option) {\n    let clickedOption = survey.selections.find((el) => {\n      return el.option == option;\n    });\n\n    let myVote = clickedOption.voter?.find((el) => {\n      return el == this.user._id;\n    });\n\n    survey.selections.forEach((el) => {\n      if (el.voter?.includes(this.user._id)) {\n        el.voter = el.voter.filter((voter) => {\n          return voter != this.user._id;\n        });\n      }\n      if (el.option == option && !myVote) {\n        el.voter = el.voter || [];\n        el.voter.push(this.user._id);\n      }\n    });\n\n    DataService.survey.patch({\n      _id: survey._id,\n      selections: survey.selections,\n    });\n  }\n\n  getSurvey() {\n    DataService.survey\n      .getAll({ queryParams: { relation: true } })\n      .then((res) => {\n        this.survey = res;\n        this.survey.forEach((el) => {\n          el.selections.forEach((option) => {\n            if (option.voter?.includes(this.user._id)) {\n              this.surveyAnswers[el.title] = option.option;\n            }\n          });\n        });\n      });\n  }\n}\n","export default \":host ion-header ion-toolbar ion-icon {\\n  padding: 10px;\\n  font-size: 1.2rem;\\n}\\n:host ion-header .border {\\n  display: block;\\n  height: 3.5px;\\n  width: 100%;\\n  position: absolute;\\n}\\n:host ion-card {\\n  font-family: \\\"Segoe UI\\\", Tahoma, Geneva, Verdana, sans-serif;\\n  border: 1px solid #dddddd;\\n}\\n:host ion-card ion-card-header {\\n  display: flex;\\n  align-items: center;\\n}\\n:host ion-card ion-card-header ion-card-title {\\n  font-size: 1.1rem;\\n  margin: 0 10px 10px 10px;\\n}\\n:host ion-card ion-card-header .survey-avatar {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  text-align: center;\\n  padding: 15px;\\n}\\n:host ion-card ion-card-header .survey-avatar ion-avatar {\\n  width: 50px;\\n  height: 50px;\\n}\\n:host ion-card ion-card-header .survey-avatar span {\\n  font-size: 0.88rem;\\n  margin: 5px;\\n}\\n:host ion-card ion-card-content ion-item ion-checkbox {\\n  --border-radius: 50%;\\n  --size: 20px;\\n  --transition: 0.5s ease-in;\\n}\\n:host ion-card ion-card-content ion-item ion-label {\\n  font-size: 0.9rem;\\n  text-indent: 1px;\\n  text-decoration: inherit;\\n}\\n:host ion-card ion-card-content ion-item span {\\n  color: gray;\\n  font-size: 0.6rem;\\n  text-align: right;\\n}\\n:host ion-card ion-radio-group {\\n  height: 300px;\\n}\\n:host ion-card ion-radio-group ion-item {\\n  margin: 0 20px 20px 20px;\\n}\\n:host ion-card ion-radio-group ion-item span {\\n  font-size: 0.8rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN1cnZleS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR1k7RUFDSSxhQUFBO0VBQ0EsaUJBQUE7QUFGaEI7QUFLUTtFQUNJLGNBQUE7RUFDQSxhQUFBO0VBQ0EsV0FBQTtFQUNBLGtCQUFBO0FBSFo7QUFRSTtFQUNJLDREQUFBO0VBQ0EseUJBQUE7QUFOUjtBQU9RO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0FBTFo7QUFNWTtFQUNJLGlCQUFBO0VBQ0Esd0JBQUE7QUFKaEI7QUFNWTtFQUNJLGFBQUE7RUFDQSxzQkFBQTtFQUNBLG1CQUFBO0VBQ0Esa0JBQUE7RUFDQSxhQUFBO0FBSmhCO0FBS2dCO0VBQ0ksV0FBQTtFQUNBLFlBQUE7QUFIcEI7QUFLZ0I7RUFDSSxrQkFBQTtFQUNBLFdBQUE7QUFIcEI7QUFTZ0I7RUFDSSxvQkFBQTtFQUNBLFlBQUE7RUFDQSwwQkFBQTtBQVBwQjtBQVNnQjtFQUNJLGlCQUFBO0VBQ0EsZ0JBQUE7RUFDQSx3QkFBQTtBQVBwQjtBQVNnQjtFQUNJLFdBQUE7RUFDQSxpQkFBQTtFQUNBLGlCQUFBO0FBUHBCO0FBV1E7RUFDSSxhQUFBO0FBVFo7QUFVWTtFQUNJLHdCQUFBO0FBUmhCO0FBaUJnQjtFQUNJLGlCQUFBO0FBZnBCIiwiZmlsZSI6InN1cnZleS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XHJcbiAgICBpb24taGVhZGVyIHtcclxuICAgICAgICBpb24tdG9vbGJhciB7XHJcbiAgICAgICAgICAgIGlvbi1pY29uIHtcclxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuMnJlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAuYm9yZGVyIHtcclxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgICAgIGhlaWdodDogMy41cHg7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpb24tY2FyZCB7XHJcbiAgICAgICAgZm9udC1mYW1pbHk6IFwiU2Vnb2UgVUlcIiwgVGFob21hLCBHZW5ldmEsIFZlcmRhbmEsIHNhbnMtc2VyaWY7XHJcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiKDIyMSwgMjIxLCAyMjEpO1xyXG4gICAgICAgIGlvbi1jYXJkLWhlYWRlciB7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgICAgICAgIGlvbi1jYXJkLXRpdGxlIHtcclxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtO1xyXG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwIDEwcHggMTBweCAxMHB4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC5zdXJ2ZXktYXZhdGFyIHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDE1cHg7XHJcbiAgICAgICAgICAgICAgICBpb24tYXZhdGFyIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogNTBweDtcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDUwcHg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzcGFuIHtcclxuICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODhyZW07XHJcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiA1cHg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaW9uLWNhcmQtY29udGVudHtcclxuICAgICAgICAgICAgaW9uLWl0ZW17XHJcbiAgICAgICAgICAgICAgICBpb24tY2hlY2tib3h7XHJcbiAgICAgICAgICAgICAgICAgICAgLS1ib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICAgICAgICAgICAgICAgICAgLS1zaXplOiAyMHB4O1xyXG4gICAgICAgICAgICAgICAgICAgIC0tdHJhbnNpdGlvbjogMC41cyBlYXNlLWluO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW9uLWxhYmVse1xyXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45cmVtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQtaW5kZW50OiAxcHg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBpbmhlcml0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3BhbntcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogZ3JheTtcclxuICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNnJlbTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiByaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpb24tcmFkaW8tZ3JvdXB7XHJcbiAgICAgICAgICAgIGhlaWdodDogMzAwcHg7XHJcbiAgICAgICAgICAgIGlvbi1pdGVte1xyXG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwIDIwcHggMjBweCAyMHB4O1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBpb24tcmFkaW97XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZm9udC1zaXplOiAyMHB4O1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGJvcmRlcjogMXB4IHNvbGlkO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgICAgICAgICAgICAgIC8vICAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgc3BhbntcclxuICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOHJlbTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ== */\";","export default \"<spica-menu-bar project=\\\"forum\\\"></spica-menu-bar>\\n<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Survey Page</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-menu-button menu=\\\"main-menu\\\"></ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n  <div class=\\\"border\\\"></div>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card *ngFor=\\\"let survey of survey\\\">\\n    <ion-card-header>\\n      <div class=\\\"survey-avatar\\\">\\n        <ion-avatar slot=\\\"start\\\">\\n          <img [src]=\\\"survey.user['profile_picture']||defaultImage\\\" />\\n        </ion-avatar>\\n        <span>{{survey.user['nick']}}</span>\\n      </div>\\n      <ion-card-title>{{survey.title}}</ion-card-title>\\n    </ion-card-header>\\n    <ion-radio-group\\n      allowEmptySelection\\n      [value]=\\\"surveyAnswers[survey.title]\\\"\\n      (click)=\\\"_vote(survey, $event.target['value'])\\\"\\n    >\\n      <ion-item *ngFor=\\\"let select of survey.selections\\\" lines=\\\"none\\\">\\n        <ion-radio mode=\\\"md\\\" slot=\\\"start\\\" [value]=\\\"select.option\\\"></ion-radio>\\n        <ion-label>{{select.option}}</ion-label>\\n        <span>{{select.voter?.length}}</span>\\n      </ion-item>\\n    </ion-radio-group>\\n  </ion-card>\\n</ion-content>\\n\";"],"sourceRoot":"webpack:///"}