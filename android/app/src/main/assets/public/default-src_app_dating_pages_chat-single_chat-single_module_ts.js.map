{"version":3,"sources":["./src/app/dating/pages/chat-single/chat-single-routing.module.ts","./src/app/dating/pages/chat-single/chat-single.module.ts","./src/app/dating/pages/chat-single/chat-single.page.ts","./src/app/dating/services/image.service.ts","./src/app/dating/pages/chat-single/chat-single.page.scss","./src/app/dating/pages/chat-single/chat-single.page.html"],"names":[],"mappings":"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","file":"default-src_app_dating_pages_chat-single_chat-single_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ChatSinglePage } from './chat-single.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatSinglePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ChatSinglePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatSinglePageRoutingModule } from './chat-single-routing.module';\n\nimport { ChatSinglePage } from './chat-single.page';\nimport { DatingComponentModule } from '../../components/dating-components.module';\nimport { SpicaComponentsModule } from 'src/app/components/components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ChatSinglePageRoutingModule,\n    DatingComponentModule,\n    SpicaComponentsModule\n  ],\n  declarations: [ChatSinglePage]\n})\nexport class ChatSinglePageModule {}\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { IonContent, IonInfiniteScroll } from '@ionic/angular';\nimport { map, share } from 'rxjs/operators';\nimport { AuthService } from '../../services/auth.service';\nimport { Chat, message, Message, User } from '../../services/bucket';\nimport { ChatService } from '../../services/chat.service';\nimport { ImageService } from '../../services/image.service';\n\n@Component({\n  selector: 'app-chat-single',\n  templateUrl: './chat-single.page.html',\n  styleUrls: ['./chat-single.page.scss'],\n})\nexport class ChatSinglePage {\n  @ViewChild(IonContent, { read: IonContent, static: false })\n  private content: IonContent;\n  @ViewChild(IonInfiniteScroll, { static: false })\n  infiniteScroll: IonInfiniteScroll;\n\n  message: string = '';\n  chatId: string;\n  messages: any[] = [];\n  $messages: any;\n  messagesSubscription: any;\n  chatGroupSubscription: any;\n  me: User;\n  opponent: User;\n  chatGroup: Chat = {};\n  usersInChatGroup: object = {};\n  loading: boolean = true;\n  loading_image: boolean = false;\n  image_message: string;\n  scroll_params = {\n    skip: 0,\n    limit: 20,\n  };\n  singleUserId;\n  constructor(\n    private _authService: AuthService,\n    private activatedRoute: ActivatedRoute,\n    private imageService: ImageService,\n    private _chatService: ChatService\n  ) {\n    this._authService.initBucket();\n  }\n  async ionViewWillEnter() {\n    this.chatId = this.activatedRoute.snapshot.paramMap.get('chat_id');\n    this.me = await this._authService.getUser().toPromise();\n    if (this.chatId != 'undefined') {\n      this.chatGroup = JSON.parse(\n        this.activatedRoute.snapshot.paramMap.get('chat')\n      );\n      if (!this.chatGroup.is_group) {\n        this.singleUserId = this.chatGroup.informations.filter(\n          (item) => item.user['_id'] != this.me._id\n        )[0].user['_id'];\n      }\n      this.getMessagesAndUpdateChat();\n      this.chatGroupSubscription = this._chatService.$chatGroups.subscribe(\n        (chatGroups: Chat[]) => {\n          let chatGroup = chatGroups.filter(\n            (ch) => ch._id == this.chatGroup._id\n          );\n          if (chatGroup.length) {\n            this.chatGroup = chatGroup[0];\n          } else {\n            this.usersInChatGroup[this.me._id].status = 'deleted';\n          }\n        }\n      );\n    } else {\n      this.loading = false;\n      this.opponent = JSON.parse(\n        this.activatedRoute.snapshot.paramMap.get('user')\n      );\n      this.chatGroup['name'] = `${this.opponent.username}`;\n    }\n    this.infiniteScroll.disabled = true;\n  }\n  ionViewWillLeave() {\n    if (this.messagesSubscription) this.messagesSubscription.unsubscribe();\n    if (this.chatGroupSubscription) this.chatGroupSubscription.unsubscribe();\n  }\n\n  getMessagesAndUpdateChat() {\n    this.chatGroup.informations.forEach((item) => {\n      this.usersInChatGroup[item.user['_id']] = item;\n    });\n    if (\n      (this.chatGroup.is_group &&\n        this.usersInChatGroup[this.me._id].status == 'active') ||\n      !this.chatGroup.is_group\n    ) {\n      this.$messages = message.realtime.getAll({\n        filter: { chat: this.chatId },\n        limit: this.scroll_params.limit,\n        skip: this.scroll_params.skip,\n        sort: { _id: -1 },\n      });\n\n      this.messagesSubscription = this.$messages\n        .pipe(\n          map((messages: []) =>\n            messages.sort((a, b) =>\n              a['_id'] > b['_id'] ? 1 : b['_id'] > a['_id'] ? -1 : 0\n            )\n          ),\n          share()\n        )\n        .subscribe(async (data) => {\n          this.scroll_params.skip = 0;\n          this._authService\n            .setOnline(\n              'chat',\n              {\n                chat: this.chatGroup._id,\n              },\n              this.me._id\n            )\n            .toPromise();\n          this.loading = false;\n          if (data.length >= this.scroll_params.limit) {\n            this.infiniteScroll.disabled = false;\n          }\n          let messages = await this.setFirstLastMessage(data);\n          this.messages = [...messages];\n          setTimeout(() => {\n            this.content.scrollToBottom(300);\n          }, 200);\n        });\n      this.chatGroup['new_message_count'] = 0;\n    }\n  }\n\n  async setFirstLastMessage(data: Message[]) {\n    let currentMessage, previousMessage;\n    let messages = [];\n    for (let [index, message] of data.entries()) {\n      previousMessage = { ...(data[index - 1] || null) };\n      currentMessage = { ...message };\n      currentMessage['first_message'] = false;\n      currentMessage['recurring'] = false;\n      if (\n        index == 0 ||\n        new Date(currentMessage.created_at).getDate() !=\n          new Date(previousMessage.created_at).getDate()\n      )\n        currentMessage['first_message'] = true;\n      if (previousMessage._id && previousMessage.owner == currentMessage.owner)\n        currentMessage['recurring'] = true;\n      messages.push(currentMessage);\n    }\n    return messages;\n  }\n  sendImage(data) {\n    this.loading_image = true;\n    let file_buf = this.imageService.toBuffer(data, 'jpeg');\n    let bufWithMeta = {\n      contentType: 'image/jpeg',\n      data: file_buf,\n      name: 'image',\n    };\n    this.imageService.insert(bufWithMeta, undefined).then((res) => {\n      this.image_message = res.url;\n      this.loading_image = false;\n    });\n  }\n  cancelImage() {\n    (this.image_message = undefined), (this.loading_image = false);\n  }\n  async sendMessage() {\n    if ((/\\S/.test(this.message) && this.message != '') || this.image_message) {\n      if (this.chatId == 'undefined') {\n        await this.createChat();\n        this.getMessagesAndUpdateChat();\n      }\n      this.$messages.insert({\n        message: this.message,\n        owner: this.me._id as User,\n        chat: this.chatId as Message,\n        image: this.image_message,\n      });\n\n      this.chatGroup = this._chatService.chatGroups.some(\n        (item) => item._id == this.chatGroup._id\n      )\n        ? this._chatService.chatGroups.filter(\n            (item) => item._id == this.chatGroup._id\n          )[0]\n        : this.chatGroup;\n\n      this._authService\n        .setOnline(\n          'chat',\n          {\n            chat: this.chatGroup._id,\n            last_message:\n              this.message || (this.image_message ? 'send photo to you' : ''),\n          },\n          this.me._id\n        )\n        .toPromise();\n      this.message = '';\n      this.image_message = undefined;\n    }\n  }\n\n  async createChat() {\n    let users = [this.me, this.opponent];\n    const data = await this._chatService\n      .createChat({\n        name: `${this.opponent.name} ${this.opponent.surname}`,\n        informations: users.map((user) => {\n          return { user: user._id };\n        }) as [],\n        managers: [this.me._id],\n      })\n      .catch((err) => console.log(err));\n\n    this.chatGroup = data as Chat;\n    this.chatGroup.informations = this.chatGroup.informations.map((item) => {\n      item.user = users.find((i) => i._id == item.user) as any;\n      return item;\n    });\n\n    this.chatId = data['_id'];\n  }\n  loadData() {\n    this.scroll_params.skip =\n      this.scroll_params.limit + this.scroll_params.skip;\n    this.getMessages().then(async (data) => {\n      this.messages = this.messages.concat(data);\n      this.messages = this.messages.sort((a, b) =>\n        a['_id'] > b['_id'] ? 1 : b['_id'] > a['_id'] ? -1 : 0\n      );\n      let messages = await this.setFirstLastMessage(this.messages);\n      this.messages = [...messages];\n      if (data.length < this.scroll_params.limit)\n        this.infiniteScroll.disabled = true;\n      this.infiniteScroll.complete();\n    });\n  }\n  getMessages() {\n    return message.getAll({\n      queryParams: {\n        filter: { chat: this.chatId },\n        limit: this.scroll_params.limit,\n        skip: this.scroll_params.skip,\n        sort: { _id: -1 },\n      },\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport * as Storage from '@spica-devkit/storage';\nimport { environment } from './environment';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ImageService {\n  constructor() {}\n\n  private init() {\n    let initializeConfig;\n    if (localStorage.getItem('socialmedia_spica_token')) {\n      initializeConfig = {\n        publicUrl: environment.apiUrl,\n        identity: localStorage.getItem('socialmedia_spica_token'),\n      };\n    } else {\n      initializeConfig = {\n        publicUrl: environment.apiUrl,\n        apikey: environment.apikey,\n      };\n    }\n    Storage.initialize(initializeConfig);\n  }\n\n  insert(storageObject, imageId): Promise<Storage.StorageObject> {\n    this.init();\n    if (imageId) {\n      return Storage.update(imageId, storageObject);\n    } else {\n      return Storage.insert(storageObject).then((v) => (v = v[0]));\n    }\n  }\n\n  toBuffer(base64, type = '') {\n    base64 = base64.split(',')[1];\n    const binaryString = window.atob(base64);\n    const len = binaryString.length;\n    const bytes = new Uint8Array(len);\n    for (let i = 0; i < len; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes.buffer;\n  }\n}","export default \":host .messages-content {\\n  padding: 15px 0px;\\n  display: flex;\\n  flex-direction: column;\\n}\\n:host .date-divider {\\n  position: relative;\\n  margin: auto;\\n  color: var(--cd-component-text-color);\\n  font-size: 0.8rem;\\n  padding: 10px;\\n  width: 100%;\\n  text-align: center;\\n}\\n:host ion-backdrop {\\n  opacity: 1;\\n  background-position: center;\\n  background-repeat: no-repeat;\\n  background-size: contain;\\n  z-index: 10;\\n  position: fixed;\\n}\\n:host spica-upload-image {\\n  margin-right: 10px;\\n  align-self: center;\\n}\\n:host ion-toolbar .send_image {\\n  width: calc(100% - 20px);\\n  object-fit: cover;\\n  margin: 10px;\\n  max-height: 400px;\\n}\\n:host ion-footer ion-icon {\\n  align-self: center;\\n}\\n:host ion-footer ion-icon.clear-text {\\n  font-size: 18px;\\n  background: transparent;\\n  color: transparent;\\n  background-image: url(\\\"data:image/svg+xml;charset=utf-8,<svg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'><path%20fill='var(--ion-color-step-600,%20%23666666)'%20d='M403.1,108.9c-81.2-81.2-212.9-81.2-294.2,0s-81.2,212.9,0,294.2c81.2,81.2,212.9,81.2,294.2,0S484.3,190.1,403.1,108.9z%20M352,340.2L340.2,352l-84.4-84.2l-84,83.8L160,339.8l84-83.8l-84-83.8l11.8-11.8l84,83.8l84.4-84.2l11.8,11.8L267.6,256L352,340.2z'/></svg>\\\");\\n}\\n:host ion-infinite-scroll-content {\\n  min-height: 5px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXQtc2luZ2xlLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDSTtFQUNFLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0FBQU47QUFFSTtFQUNFLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLHFDQUFBO0VBQ0EsaUJBQUE7RUFDQSxhQUFBO0VBQ0EsV0FBQTtFQUNBLGtCQUFBO0FBQU47QUFFSTtFQUNFLFVBQUE7RUFDQSwyQkFBQTtFQUNBLDRCQUFBO0VBQ0Esd0JBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtBQUFOO0FBRUk7RUFDRSxrQkFBQTtFQUNBLGtCQUFBO0FBQU47QUFHTTtFQUNFLHdCQUFBO0VBQ0EsaUJBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7QUFEUjtBQUtNO0VBQ0Usa0JBQUE7QUFIUjtBQUlRO0VBQ0UsZUFBQTtFQUNBLHVCQUFBO0VBQ0Esa0JBQUE7RUFDQSwyYkFBQTtBQUZWO0FBTUk7RUFDRSxlQUFBO0FBSk4iLCJmaWxlIjoiY2hhdC1zaW5nbGUucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuICAgIC5tZXNzYWdlcy1jb250ZW50IHtcbiAgICAgIHBhZGRpbmc6IDE1cHggMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgfVxuICAgIC5kYXRlLWRpdmlkZXIge1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgbWFyZ2luOiBhdXRvO1xuICAgICAgY29sb3I6IHZhcigtLWNkLWNvbXBvbmVudC10ZXh0LWNvbG9yKTtcbiAgICAgIGZvbnQtc2l6ZTogMC44cmVtO1xuICAgICAgcGFkZGluZzogMTBweDtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIH1cbiAgICBpb24tYmFja2Ryb3Age1xuICAgICAgb3BhY2l0eTogMTtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjtcbiAgICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG4gICAgICB6LWluZGV4OiAxMDtcbiAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB9XG4gICAgc3BpY2EtdXBsb2FkLWltYWdlIHtcbiAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcbiAgICAgIGFsaWduLXNlbGY6IGNlbnRlcjtcbiAgICB9XG4gICAgaW9uLXRvb2xiYXIge1xuICAgICAgLnNlbmRfaW1hZ2Uge1xuICAgICAgICB3aWR0aDogY2FsYygxMDAlIC0gMjBweCk7XG4gICAgICAgIG9iamVjdC1maXQ6IGNvdmVyO1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIG1heC1oZWlnaHQ6IDQwMHB4O1xuICAgICAgfVxuICAgIH1cbiAgICBpb24tZm9vdGVyIHtcbiAgICAgIGlvbi1pY29uIHtcbiAgICAgICAgYWxpZ24tc2VsZjogY2VudGVyO1xuICAgICAgICAmLmNsZWFyLXRleHQge1xuICAgICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgICBjb2xvcjogdHJhbnNwYXJlbnQ7XG4gICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsPHN2ZyUyMHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyclMjB2aWV3Qm94PScwJTIwMCUyMDUxMiUyMDUxMic+PHBhdGglMjBmaWxsPSd2YXIoLS1pb24tY29sb3Itc3RlcC02MDAsJTIwJTIzNjY2NjY2KSclMjBkPSdNNDAzLjEsMTA4LjljLTgxLjItODEuMi0yMTIuOS04MS4yLTI5NC4yLDBzLTgxLjIsMjEyLjksMCwyOTQuMmM4MS4yLDgxLjIsMjEyLjksODEuMiwyOTQuMiwwUzQ4NC4zLDE5MC4xLDQwMy4xLDEwOC45eiUyME0zNTIsMzQwLjJMMzQwLjIsMzUybC04NC40LTg0LjJsLTg0LDgzLjhMMTYwLDMzOS44bDg0LTgzLjhsLTg0LTgzLjhsMTEuOC0xMS44bDg0LDgzLjhsODQuNC04NC4ybDExLjgsMTEuOEwyNjcuNiwyNTZMMzUyLDM0MC4yeicvPjwvc3ZnPlwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpb24taW5maW5pdGUtc2Nyb2xsLWNvbnRlbnQge1xuICAgICAgbWluLWhlaWdodDogNXB4O1xuICAgIH1cbiAgfVxuICAiXX0= */\";","export default \"<ion-header mode=\\\"ios\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"dating/tabs/chats\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title\\n      *ngIf=\\\"chatGroup\\\"\\n      [routerLink]=\\\"chatGroup.is_group ? ['chat_detail'] : ['profile',singleUserId]\\\"\\n      >{{chatGroup.name}}\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content #content>\\n  <ion-infinite-scroll\\n    position=\\\"top\\\"\\n    threshold=\\\"0px\\\"\\n    (ionInfinite)=\\\"loadData()\\\"\\n  >\\n    <ion-infinite-scroll-content loadingSpinner=\\\"bubbles\\\">\\n    </ion-infinite-scroll-content>\\n  </ion-infinite-scroll>\\n  <ng-container\\n    *ngIf=\\\"(usersInChatGroup && me) && ((chatGroup.is_group && usersInChatGroup[me._id]?.status == 'active') || !chatGroup.is_group)\\\"\\n  >\\n    <ng-container *ngFor=\\\"let message of messages;let index = index\\\">\\n      <div class=\\\"date-divider\\\" *ngIf=\\\"message['first_message']\\\">\\n        {{message.created_at |Â date: \\\"dd/MM/YYYY\\\"}}\\n      </div>\\n      <message\\n        [date]=\\\"message.created_at\\\"\\n        [recurring]=\\\"message['recurring']\\\"\\n        [avatar]=\\\"!messages[(index + 1)] || messages[(index + 1)].owner != message.owner ? usersInChatGroup[message.owner].user.profile_photo : 'none'\\\"\\n        [message]=\\\"message.message\\\"\\n        [isCurrentUser]=\\\"message.owner == me._id\\\"\\n        [image]=\\\"message.image\\\"\\n        [id]=\\\"usersInChatGroup[message.owner].user._id\\\"\\n        mode=\\\"chat\\\"\\n      ></message>\\n    </ng-container>\\n  </ng-container>\\n  <ng-container\\n    *ngIf=\\\"(usersInChatGroup && me) && usersInChatGroup[me._id]?.status != 'active' && chatGroup.is_group\\\"\\n  >\\n    <div class=\\\"empty-placeholder\\\">\\n      You can't see any message because you are not in this chat group anymore\\n    </div>\\n  </ng-container>\\n\\n  <ion-spinner\\n    class=\\\"spinner-center-page\\\"\\n    name=\\\"crescent\\\"\\n    *ngIf=\\\"loading\\\"\\n  ></ion-spinner>\\n</ion-content>\\n<ion-footer class=\\\"ion-no-border\\\">\\n  <ion-toolbar\\n    *ngIf=\\\"(usersInChatGroup && me) && ((usersInChatGroup[me._id]?.status == 'active' && chatGroup.is_group) || !chatGroup.is_group)\\\"\\n  >\\n    <ion-item *ngIf=\\\"image_message\\\">\\n      <img class=\\\"send_image\\\" [src]=\\\"image_message\\\" />\\n    </ion-item>\\n    <ion-item lines=\\\"none\\\">\\n      <spica-upload-image slot=\\\"start\\\"\\n        *ngIf=\\\"!loading_image &&!message && !image_message\\\"\\n        (change)=\\\"sendImage($event)\\\"\\n      ></spica-upload-image>\\n      <ion-textarea\\n        *ngIf=\\\"!image_message\\\"\\n        [(ngModel)]=\\\"message\\\"\\n        placeholder=\\\"Send Message\\\"\\n        enterkeyhint=\\\"send\\\"\\n        autoGrow=\\\"true\\\"\\n        rows=\\\"1\\\"\\n      ></ion-textarea>\\n      <ion-icon\\n        class=\\\"clear-text\\\"\\n        *ngIf=\\\"message\\\"\\n        (click)=\\\"message=''\\\"\\n        name=\\\"close-circle-outline\\\"\\n      ></ion-icon>\\n      <ion-spinner\\n        *ngIf=\\\"loading_image\\\"\\n        name=\\\"crescent\\\"\\n        slot=\\\"end\\\"\\n      ></ion-spinner>\\n      <ion-icon\\n        *ngIf=\\\"!loading_image && !message && image_message\\\"\\n        name=\\\"close\\\"\\n        slot=\\\"end\\\"\\n        (click)=\\\"cancelImage()\\\"\\n      >\\n      </ion-icon>\\n      <ion-icon\\n        *ngIf=\\\"!loading_image\\\"\\n        name=\\\"send-outline\\\"\\n        slot=\\\"end\\\"\\n        (click)=\\\"sendMessage()\\\"\\n      ></ion-icon>\\n    </ion-item>\\n  </ion-toolbar>\\n</ion-footer>\\n\";"],"sourceRoot":"webpack:///"}