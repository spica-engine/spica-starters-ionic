{"version":3,"sources":["./src/app/dating/pages/user-details/user-details-routing.module.ts","./src/app/dating/pages/user-details/user-details.module.ts","./src/app/dating/pages/user-details/user-details.page.ts","./src/app/dating/pages/user-details/user-details.page.scss","./src/app/dating/pages/user-details/user-details.page.html"],"names":[],"mappings":"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","file":"src_app_dating_pages_user-details_user-details_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { UserDetailsPage } from './user-details.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserDetailsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class UserDetailsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserDetailsPageRoutingModule } from './user-details-routing.module';\n\nimport { UserDetailsPage } from './user-details.page';\nimport { DatingComponentModule } from '../../components/dating-components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    UserDetailsPageRoutingModule,\n    DatingComponentModule\n  ],\n  declarations: [UserDetailsPage]\n})\nexport class UserDetailsPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CommonService } from 'src/app/services/common.service';\nimport { AuthService } from '../../services/auth.service';\nimport { User, user, likes, Likes, unlikes } from '../../services/bucket';\nimport { ChatService } from '../../services/chat.service';\nimport { ChoiseActionService } from '../../services/choise-action.service';\n\n@Component({\n  selector: 'app-user-details',\n  templateUrl: './user-details.page.html',\n  styleUrls: ['./user-details.page.scss'],\n})\nexport class UserDetailsPage implements OnInit {\n  user: User;\n  me: User;\n  showMatch: boolean = false;\n  isMatched: boolean = false;\n  isChoosed: boolean = true;\n  isLoading: boolean = true;\n  constructor(\n    private _route: ActivatedRoute,\n    private _authService: AuthService,\n    private _choiceService: ChoiseActionService,\n    public commonService: CommonService,\n    private _chatService: ChatService,\n    private _router: Router\n  ) {\n    this._authService.initBucket;\n  }\n\n  async ngOnInit() {\n    let userId = this._route.snapshot.params.id;\n    this._route.queryParams.subscribe((param) => {\n      this.isMatched = param.isMatched == 'true' ? true : false;\n    });\n\n    this.user = await this.getUser(userId);\n    this.me = await this._authService.getUser().toPromise();\n    \n    this.user.gallery = this.user.gallery || [];\n    this.user.gallery.push(this.user.profile_photo);\n\n    this.checkLike();\n    this.isLoading = false;\n  }\n\n  getUser(id) {\n    return user.get(id);\n  }\n\n  async checkLike() {\n    let like = await likes.getAll({\n      queryParams: { filter: { user: this.user._id, liked_user: this.me._id } },\n    });\n    if (!like.length) {\n      let unlike = await unlikes.getAll({\n        queryParams: {\n          filter: { user: this.user._id, unliked_user: this.me._id },\n        },\n      });\n      if (!unlike.length) {\n        this.isChoosed = false;\n        return;\n      }\n    }\n  }\n\n  choice(value) {\n    this._choiceService.insertChoice(value, this.user._id, this.me._id);\n    if (value == 'like') {\n      this.showMatch = true;\n    } else {\n      this.isChoosed = true;\n    }\n  }\n\n  matchAction(value) {\n    if(value == 'message'){\n      this.sendSms();\n    }\n    this.showMatch = false;\n    this.isMatched = true;\n    this.isChoosed = true;\n  }\n\n  async sendSms(){\n    this.isLoading = true;\n    let chatUsers = [this.me, this.user];\n    \n    let name = `${chatUsers[0].username}, ${chatUsers[1].username}...`;\n    let chatExists = await this._chatService.isChatExists(chatUsers);\n    if (!chatExists.result) {\n      if (chatUsers.length == 2) {\n        this.navigateToChat();\n      } else\n        this._chatService.createChat({\n          managers: [this.user._id],\n          name: name,\n          is_group: chatUsers.length > 2,\n          informations: chatUsers.map((user) => {\n            return { user: user._id };\n          }) as [],\n        });\n    } else {\n      this._router.navigate([\n        `dating/tabs/chats/${chatExists.chat['_id']}`,\n        { chat: JSON.stringify(chatExists.chat) },\n      ]);\n    }\n  }\n\n  navigateToChat() {\n    this._router.navigate([\n      `dating/tabs/chats/${undefined}`,\n      { user: JSON.stringify(this.user) },\n    ]);\n  }\n}\n","export default \":host ion-content .gallery-slide {\\n  height: 260px;\\n  max-height: 260px;\\n}\\n:host ion-content .gallery-slide ion-slide img {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n}\\n:host ion-content .user-info {\\n  padding: 0 15px;\\n  display: flex;\\n  flex-direction: column;\\n}\\n:host ion-content .user-info ion-button {\\n  margin-bottom: 15px;\\n}\\n:host ion-content .user-info ion-label {\\n  display: flex;\\n  align-items: center;\\n  font-size: 14px;\\n  color: gray;\\n}\\n:host ion-content .user-info ion-label ion-text {\\n  margin-left: 7px;\\n}\\n:host ion-content .user-info p {\\n  color: gray;\\n  font-size: 14px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItZGV0YWlscy5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUk7RUFDRSxhQUFBO0VBQ0EsaUJBQUE7QUFETjtBQUlRO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtBQUZWO0FBT0k7RUFDRSxlQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0FBTE47QUFNTTtFQUNFLG1CQUFBO0FBSlI7QUFNTTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7RUFDQSxXQUFBO0FBSlI7QUFLUTtFQUNFLGdCQUFBO0FBSFY7QUFNTTtFQUNFLFdBQUE7RUFDQSxlQUFBO0FBSlIiLCJmaWxlIjoidXNlci1kZXRhaWxzLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgaW9uLWNvbnRlbnQge1xuICAgIC5nYWxsZXJ5LXNsaWRlIHtcbiAgICAgIGhlaWdodDogMjYwcHg7XG4gICAgICBtYXgtaGVpZ2h0OiAyNjBweDtcblxuICAgICAgaW9uLXNsaWRlIHtcbiAgICAgICAgaW1nIHtcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgb2JqZWN0LWZpdDogY292ZXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAudXNlci1pbmZve1xuICAgICAgcGFkZGluZzogMCAxNXB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICBpb24tYnV0dG9ue1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4O1xuICAgICAgfVxuICAgICAgaW9uLWxhYmVse1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIGNvbG9yOiBncmF5O1xuICAgICAgICBpb24tdGV4dHtcbiAgICAgICAgICBtYXJnaW4tbGVmdDogN3B4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBwe1xuICAgICAgICBjb2xvcjogZ3JheTtcbiAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */\";","export default \"<ion-header mode=\\\"ios\\\">\\n  <ion-toolbar>\\n    <ion-back-button slot=\\\"start\\\"></ion-back-button>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ng-container *ngIf=\\\"!isLoading && user\\\">\\n    <ion-slides [pager]=\\\"user.gallery?.length > 1\\\" class=\\\"gallery-slide\\\">\\n      <ion-slide *ngFor=\\\"let image of user.gallery\\\">\\n        <img [src]=\\\"image\\\" />\\n      </ion-slide>\\n    </ion-slides>\\n    <div class=\\\"user-info\\\">\\n      <h5>\\n        {{user.name + ' ' + user.surname + ', ' +\\n        commonService.calculateAge(user.birthday)}}\\n      </h5>\\n      <ion-button *ngIf=\\\"isMatched\\\" (click)=\\\"sendSms()\\\">Send Message</ion-button>\\n      <ion-label *ngIf=\\\"user.school\\\"><ion-icon name=\\\"school\\\"></ion-icon> <ion-text>{{user.school}}</ion-text></ion-label>\\n      <ion-label *ngIf=\\\"user.job\\\"><ion-icon name=\\\"briefcase\\\"></ion-icon><ion-text>{{user.job}}</ion-text></ion-label>\\n      <p>{{user.description}}</p>\\n    </div>\\n  </ng-container>\\n  <ion-spinner\\n    *ngIf=\\\"isLoading\\\"\\n    class=\\\"spinner-center-page\\\"\\n    name=\\\"crescent\\\"\\n  ></ion-spinner>\\n</ion-content>\\n\\n<ion-footer class=\\\"ion-no-border\\\" *ngIf=\\\"!isLoading && !isChoosed\\\">\\n  <ion-toolbar>\\n    <action-bar (choiseAction)=\\\"choice($event)\\\"></action-bar>\\n  </ion-toolbar>\\n</ion-footer>\\n\\n<match-dialog *ngIf=\\\"me && user && showMatch\\\" [users]=\\\"[me, user]\\\" (action)=\\\"matchAction($event)\\\"></match-dialog>\\n\";"],"sourceRoot":"webpack:///"}