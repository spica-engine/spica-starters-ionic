{"version":3,"sources":["./src/app/music-streaming/pages/library/library-routing.module.ts","./src/app/music-streaming/pages/library/library.module.ts","./src/app/music-streaming/pages/library/library.page.ts","./src/app/music-streaming/pages/library/library.page.scss","./src/app/music-streaming/pages/library/library.page.html"],"names":[],"mappings":"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","file":"src_app_music-streaming_pages_library_library_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LibraryPage } from './library.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LibraryPage\n  },\n  {\n    path: 'list',\n    loadChildren: () => import('../list/list.module').then( m => m.ListPageModule)\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LibraryPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LibraryPageRoutingModule } from './library-routing.module';\n\nimport { LibraryPage } from './library.page';\nimport { MusicStreamingComponentModule } from '../../components/music-components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LibraryPageRoutingModule,\n    MusicStreamingComponentModule\n  ],\n  declarations: [LibraryPage]\n})\nexport class LibraryPageModule {}\n","import { Component } from '@angular/core';\nimport { AuthService } from '../../services/auth.service';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport * as DataService from '../../services/bucket';\nimport { CreatePlayListComponent } from '../../components/create-play-list/create-play-list.component';\nimport { Router } from '@angular/router';\nimport { FollowableModalComponent } from '../../components/followable-modal/followable-modal.component';\nimport { environment } from '../../services/environment';\n\n@Component({\n  selector: 'app-library',\n  templateUrl: './library.page.html',\n  styleUrls: ['./library.page.scss'],\n})\nexport class LibraryPage {\n  userId: string;\n  user: DataService.User;\n  playLists: DataService.Playlist[] = [];\n  defaultImage = environment.user_img;\n  isLoading: boolean = true;\n\n  constructor(\n    private _authService: AuthService,\n    private _modalController: ModalController,\n    private _router: Router,\n    private _alertController: AlertController\n  ) {\n    this._authService.initBucket();\n  }\n\n  async ionViewWillEnter() {\n    this.userId = (await this._authService.getUser().toPromise())?._id;\n    await this.getUser();\n    this.playLists = (await this.getPlayLists()) as DataService.Playlist[];\n    this.isLoading = false;\n  }\n\n  async getUser() {\n    this.user = await DataService.user.get(this.userId, {\n      queryParams: { relation: true },\n    });\n  }\n\n  async createPlayListModal() {\n    const modal = await this._modalController.create({\n      component: CreatePlayListComponent,\n    });\n\n    modal.onWillDismiss().then(async (res) => {\n      if (!res.data) {\n        return;\n      }\n      let newPlaylist = await this.createPlayList(res.data.title);\n      this.playLists.push(newPlaylist);\n    });\n\n    return await modal.present();\n  }\n\n  async createPlayList(name) {\n    return DataService.playlist.insert({\n      name: name,\n      owner: this.user._id,\n    });\n  }\n\n  getPlayLists() {\n    return DataService.playlist\n      .getAll({ queryParams: { filter: { owner: this.user._id } } })\n      .catch((err) => console.log(err));\n  }\n\n  navigateToList(id) {\n    this._router.navigate([`/music-streaming/tabs/library/list/${id}`], {\n      queryParams: { type: 'playList' },\n    });\n  }\n\n  itemClicked(event, id) {\n    if (event == 'action') {\n      this.presentAlert(id);\n    }\n  }\n\n  async presentAlert(id) {\n    const alert = await this._alertController.create({\n      message: 'Are you sure you want to unfollow?',\n      buttons: [\n        'Cancel',\n        {\n          text: 'Confirm',\n          handler: () => {\n            this.unfolowArtist(id);\n          },\n        },\n      ],\n    });\n    await alert.present();\n  }\n\n  unfolowArtist(id) {\n    this.user.followed_artists = this.user.followed_artists.filter((artist) => {\n      return artist['_id'] != id;\n    });\n    DataService.user.patch({\n      _id: this.user._id,\n      followed_artists: this.user.followed_artists,\n    });\n  }\n\n  async followableModal() {\n    const modal = await this._modalController.create({\n      component: FollowableModalComponent,\n      componentProps: {\n        type: 'artist',\n      },\n    });\n\n    modal.onWillDismiss().then((res) => {\n      if (!res.data) {\n        return;\n      }\n      this.getUser();\n    });\n\n    return await modal.present();\n  }\n}\n","export default \":host ion-toolbar {\\n  padding: 0 10px;\\n}\\n:host ion-toolbar ion-icon {\\n  font-size: 28px;\\n}\\n:host ion-content .container {\\n  padding: 15px;\\n  margin-bottom: 70px;\\n}\\n:host ion-content .container .artist-item::ng-deep .action-icon {\\n  color: #aa0000;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnJhcnkucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNFO0VBQ0UsZUFBQTtBQUFKO0FBQ0k7RUFDRSxlQUFBO0FBQ047QUFJSTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtBQUZOO0FBTVU7RUFDRSxjQUFBO0FBSloiLCJmaWxlIjoibGlicmFyeS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gIGlvbi10b29sYmFyIHtcbiAgICBwYWRkaW5nOiAwIDEwcHg7XG4gICAgaW9uLWljb24ge1xuICAgICAgZm9udC1zaXplOiAyOHB4O1xuICAgIH1cbiAgfVxuXG4gIGlvbi1jb250ZW50IHtcbiAgICAuY29udGFpbmVyIHtcbiAgICAgIHBhZGRpbmc6IDE1cHg7XG4gICAgICBtYXJnaW4tYm90dG9tOiA3MHB4O1xuXG4gICAgICAuYXJ0aXN0LWl0ZW0ge1xuICAgICAgICAmOjpuZy1kZWVwIHtcbiAgICAgICAgICAuYWN0aW9uLWljb24ge1xuICAgICAgICAgICAgY29sb3I6IHJnYigxNzAsIDAsIDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */\";","export default \"<ion-header mode=\\\"ios\\\">\\n  <ion-toolbar>\\n    <ion-avatar [routerLink]=\\\"['/music-streaming/profile']\\\" slot=\\\"start\\\">\\n      <img [src]=\\\"user && user['profile_picture'] ||  defaultImage \\\" />\\n    </ion-avatar>\\n    <ion-title>Library</ion-title>\\n    <ion-icon slot=\\\"end\\\" name=\\\"add\\\" (click)=\\\"createPlayListModal()\\\"></ion-icon>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div class=\\\"container\\\" *ngIf=\\\"user\\\">\\n    <music-list-item\\n      *ngFor=\\\"let playList of playLists\\\"\\n      lines=\\\"none\\\"\\n      (click)=\\\"navigateToList(playList._id)\\\"\\n      [data]=\\\"{\\n      image: playList.image,\\n      avatarIcon: 'musical-notes-outline',\\n      title: playList.name,\\n      subTitle: 'Play list | ' + user.username\\n    }\\\"\\n    >\\n    </music-list-item>\\n\\n    <music-list-item\\n      *ngFor=\\\"let artist of user.followed_artists || []\\\"\\n      [data]=\\\"{\\n      image: artist['profile_picture'],\\n      title: artist['name'],\\n      subTitle: 'Artist',\\n      actionIcon: 'remove-circle-outline',\\n      isCircle: true\\n    }\\\"\\n      class=\\\"artist-item\\\"\\n      (clickAction)=\\\"itemClicked($event, artist['_id'])\\\"\\n    >\\n    </music-list-item>\\n\\n    <music-list-item\\n      [data]=\\\"{\\n      avatarIcon: 'add',\\n      title: 'Add Followed Artist',\\n      isCircle: true\\n    }\\\"\\n      (clickAction)=\\\"followableModal()\\\"\\n    >\\n    </music-list-item>\\n  </div>\\n  <ion-spinner class=\\\"spinner-center-page\\\" *ngIf=\\\"isLoading\\\"></ion-spinner>\\n\\n</ion-content>\\n\";"],"sourceRoot":"webpack:///"}